<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Commande Timeless</title>
<style>
  body { margin: 0; font-family: Arial, sans-serif; background: #121212; color: #fff; overflow-x: hidden; }
  header { text-align: center; padding: 20px; background: #1a1a1a; }
  header img { max-width: 200px; }
  h1 { color: #ffcc00; margin-top: 10px; font-size: 24px; }
  .category { padding: 10px 20px; }
  .category h2 { color: #ffcc00; margin-bottom: 10px; }
  .item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #333; }
  .item-name { flex: 1; }
  .item-controls { display: flex; align-items: center; }
  .item-controls button { width: 40px; height: 40px; margin: 0 5px; background: #ffcc00; color: #000; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; transition: transform 0.1s; }
  .item-controls button:active { transform: scale(1.2); }
  .item-controls span { min-width: 30px; text-align: center; display: inline-block; font-size: 16px; }
  #cartOverlay { position: fixed; bottom: -100%; left: 0; right: 0; background: #1f1f1f; padding: 20px; border-top: 3px solid #ffcc00; transition: bottom 0.3s; max-height: 60%; overflow-y: auto; z-index: 10; }
  #cartOverlay.show { bottom: 0; }
  #cartItems .cart-item { display: flex; justify-content: space-between; padding: 5px 0; }
  #cartTotal { font-weight: bold; margin-top: 10px; }
  #cartToggle { position: fixed; bottom: 80px; right: 20px; background: #ffcc00; color: #000; border: none; padding: 12px 18px; border-radius: 50px; font-weight: bold; cursor: pointer; z-index: 11; }
  #tableNumber { padding: 12px; width: 100%; max-width: 120px; margin: 10px 0; border-radius: 5px; border: none; text-align: center; font-size: 16px; }
  #sendOrder { background: #ffcc00; color: #000; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; width: 100%; margin-top: 10px; }
  #sendOrder:disabled { background: #999; cursor: not-allowed; }
  #confirmation { color: #00ff00; font-weight: bold; text-align: center; margin-top: 10px; }
</style>
</head>
<body>

<header>
  <img src="https://primary.jwwb.nl/public/p/i/g/temp-nokpyfusksecizrwekic/timeless-high-0qy9j8.png?enable-io=true&crop=3.4119%3A1%2Coffset-x46%2Coffset-y27&width=532" alt="Logo Timeless">
  <h1>Commande Boissons & Snacks</h1>
</header>

<div class="category" id="drinksCategory">
  <h2>Boissons</h2>
</div>

<div class="category" id="snacksCategory">
  <h2>Snacks</h2>
</div>

<button id="cartToggle">Voir le panier</button>

<div id="cartOverlay">
  <h2>Panier</h2>
  <form id="cartForm" action="https://formspree.io/f/xqajqlyo" method="POST">
    <div id="cartItems"></div>
    <div id="cartTotal">Total: €0.00</div>
    <input type="number" id="tableNumber" name="tableNumber" placeholder="N° Table" min="1" required>
    <input type="hidden" name="orderDetails" id="orderDetails">
    <button type="submit" id="sendOrder">Envoyer la commande</button>
  </form>
  <div id="confirmation"></div>
</div>

<script>
const articles = [
  {name: "Eau plate", price: 2, category: "drinks"},
  {name: "Eau pétillante", price: 2, category: "drinks"},
  {name: "Coca", price: 2, category: "drinks"},
  {name: "Coca zéro", price: 2, category: "drinks"},
  {name: "Fanta orange", price: 2, category: "drinks"},
  {name: "Iced Tea", price: 2, category: "drinks"},
  {name: "Café", price: 2, category: "drinks"},
  {name: "Jupiler", price: 2.5, category: "drinks"},
  {name: "Blanche Rosée", price: 3, category: "drinks"},
  {name: "Vin blanc", price: 3.5, category: "drinks"},
  {name: "Vin rouge", price: 3.5, category: "drinks"},
  {name: "Cocktail Timeless", price: 4, category: "drinks"},
  {name: "Chips", price: 2, category: "snacks"},
  {name: "Assiette Apéro", price: 7, category: "snacks"}
];
const cart = {};

function updateCart() {
  const cartItemsDiv = document.getElementById('cartItems');
  cartItemsDiv.innerHTML = '';
  let total = 0;
  let orderDetails = '';
  for(const item in cart){
    if(cart[item] > 0){
      const article = articles.find(a => a.name===item);
      const subtotal = article.price * cart[item];
      total += subtotal;
      orderDetails += `${item} x ${cart[item]} - €${subtotal.toFixed(2)}\n`;
      const div = document.createElement('div');
      div.className = 'cart-item';
      div.innerText = `${item} x ${cart[item]} - €${subtotal.toFixed(2)}`;
      cartItemsDiv.appendChild(div);
    }
  }
  // Ajouter le total général
  orderDetails += `\nTotal général: €${total.toFixed(2)}`;
  document.getElementById('cartTotal').innerText = `Total: €${total.toFixed(2)}`;
  document.getElementById('orderDetails').value = orderDetails;

  articles.forEach(article => {
    const qtySpan = document.getElementById(`qty-${article.name}`);
    if(qtySpan) qtySpan.innerText = cart[article.name] || 0;
  });
}

function addItem(name){ cart[name]=(cart[name]||0)+1; updateCart(); }
function removeItem(name){ if(cart[name]){ cart[name]--; updateCart(); } }

function renderItems(){
  articles.forEach(article=>{
    const div = document.createElement('div');
    div.className='item';
    div.innerHTML=`
      <span class="item-name">${article.name} - €${article.price.toFixed(2)}</span>
      <div class="item-controls">
        <button type="button" onclick="removeItem('${article.name}')">-</button>
        <span id="qty-${article.name}">0</span>
        <button type="button" onclick="addItem('${article.name}')">+</button>
      </div>
    `;
    if(article.category==="drinks") document.getElementById('drinksCategory').appendChild(div);
    else document.getElementById('snacksCategory').appendChild(div);
  });
}
renderItems();

const cartOverlay = document.getElementById('cartOverlay');
document.getElementById('cartToggle').addEventListener('click', ()=>{
  cartOverlay.classList.toggle('show');
});

const cartForm = document.getElementById('cartForm');
const sendButton = document.getElementById('sendOrder');
cartForm.addEventListener('submit', (e)=>{
  if(Object.values(cart).every(q => q===0)){
    e.preventDefault();
    alert('Votre panier est vide.');
    return;
  }

  sendButton.disabled = true;
  document.getElementById('confirmation').innerText = "Commande en cours d'envoi...";

  // Le formulaire est envoyé à Formspree automatiquement
  setTimeout(() => {
    for(const item in cart) cart[item] = 0;
    updateCart();
    cartOverlay.classList.remove('show');
    document.getElementById('tableNumber').value = "";
    document.getElementById('confirmation').innerText = "Commande envoyée !";
    sendButton.disabled = false;
  }, 1000);
});
</script>

</body>
</html>
